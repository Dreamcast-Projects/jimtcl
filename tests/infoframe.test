source [file dirname [info script]]/testing.tcl

proc a {n} {
	if {$n eq "trace"} {
		return [basename-stacktrace [stacktrace]]
	}
	set frame [info frame $n]
	if {![dict exists $frame proc]} {
		dict set frame proc {}
	}
	basename-stacktrace [list [dict get $frame proc] [file tail [dict get $frame file]] [dict get $frame line]]
}

proc b {n} {
	a $n
}

proc c {n} {
	b $n
}

# --- Don't change line numbers above

test info-frame-1.1 {Current command} -body {
	c 0
} -result {a infoframe.test 7}

test info-frame-1.2 {Current Proc} -body {
	c -1
} -result {b infoframe.test 15}

test info-frame-1.3 Caller -body {
	c -2
} -result {c infoframe.test 19}

test info-frame-1.4 {Caller of Caller} -body {
	c -3
} -result {test infoframe.test 37}

test stacktrace-1.1 {Full stack trace} -body {
	c trace
} -result {a infoframe.test 5 b infoframe.test 15 c infoframe.test 19 test infoframe.test 41}

testreport
